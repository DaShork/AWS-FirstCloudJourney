<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 1 :: Internship Report</title>
<link href=../../css/nucleus.css?1765453894 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765453894 rel=stylesheet><link href=../../css/hybrid.css?1765453894 rel=stylesheet><link href=../../css/featherlight.min.css?1765453894 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765453894 rel=stylesheet><link href=../../css/auto-complete.css?1765453894 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765453894 rel=stylesheet><link href=../../css/theme.css?1765453894 rel=stylesheet><link href=../../css/hugo-theme.css?1765453894 rel=stylesheet><link href=../../css/theme-workshop.css?1765453894 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765453894></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.1-blog1/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765453894></script><script type=text/javascript src=../../js/auto-complete.js?1765453894></script><script type=text/javascript>var baseurl="https://dashork.github.io/AWS-FirstCloudJourney/"</script><script type=text/javascript src=../../js/search.js?1765453894></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title=Worklog class=dd-item><a href=../../1-worklog/><b>1. </b>Worklog
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Week 9 Worklog" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Week 9 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Week 10 Worklog" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Week 10 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Week 11 Worklog" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Week 11 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Week 12 Worklog" class=dd-item><a href=../../1-worklog/1.12-week12/><b>1.12. </b>Week 12 Worklog
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class="dd-item
active"><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Attended" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Attended
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=../../4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.3-event3/ title="Event 3" class=dd-item><a href=../../4-eventparticipated/4.3-event3/><b>4.3. </b>Event 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.4-event4/ title="Event 4" class=dd-item><a href=../../4-eventparticipated/4.4-event4/><b>4.4. </b>Event 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.5-event5/ title="Event 5" class=dd-item><a href=../../4-eventparticipated/4.5-event5/><b>4.5. </b>Event 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title=Workshop class=dd-item><a href=../../5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title="1. Workshop Overview" class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>1. Workshop Overview
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title="2. Preparation Steps" class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>2. Preparation Steps
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.2-prerequiste/5.2.1-create-s3-bucket/ title="Create S3 Bucket" class=dd-item><a href=../../5-workshop/5.2-prerequiste/5.2.1-create-s3-bucket/><b>5.2.1 </b>Create S3 Bucket
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/5.2.2-download-source-code/ title="Upload Resources" class=dd-item><a href=../../5-workshop/5.2-prerequiste/5.2.2-download-source-code/><b>5.2.2 </b>Upload Resources
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.3-s3-static-web/ title="3. Enable S3 Static Website Hosting" class=dd-item><a href=../../5-workshop/5.3-s3-static-web/><b>5.3. </b>3. Enable S3 Static Website Hosting
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-config-block-public/ title="4. Configure Block Public Access" class=dd-item><a href=../../5-workshop/5.4-config-block-public/><b>5.4. </b>4. Configure Block Public Access
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-config-public-object/ title="5. Configure Public Object" class=dd-item><a href=../../5-workshop/5.5-config-public-object/><b>5.5 </b>5. Configure Public Object
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.6-check-website/ title="6. Verify Website" class=dd-item><a href=../../5-workshop/5.6-check-website/><b>5.6 </b>6. Verify Website
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.7-cloudfront/ title="7. CloudFront" class=dd-item><a href=../../5-workshop/5.7-cloudfront/><b>5.7. </b>7. CloudFront
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.7-cloudfront/5.7.1-block-public-access/ title="Block Public Access" class=dd-item><a href=../../5-workshop/5.7-cloudfront/5.7.1-block-public-access/><b>5.7.1 </b>Block Public Access
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.7-cloudfront/5.7.2-config-cloudfront/ title="Configure CloudFront" class=dd-item><a href=../../5-workshop/5.7-cloudfront/5.7.2-config-cloudfront/><b>5.7.2 </b>Configure CloudFront
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.7-cloudfront/5.7.3-deploy-cloudfront/ title="Deploy CloudFront" class=dd-item><a href=../../5-workshop/5.7-cloudfront/5.7.3-deploy-cloudfront/><b>5.7.3 </b>Deploy CloudFront
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.8-cleanup/ title="8. Cleanup Resources" class=dd-item><a href=../../5-workshop/5.8-cleanup/><b>5.8. </b>8. Cleanup Resources
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://dashork.github.io/AWS-FirstCloudJourney/3-blogstranslated/3.1-blog1/ selected>English</option><option id=vi value=https://dashork.github.io/AWS-FirstCloudJourney/vi/3-blogstranslated/3.1-blog1/>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 1</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#amazon-bedrock-guardrails-apis>Amazon Bedrock Guardrails APIs</a></li><li><a href=#solution-overview>Solution Overview</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#amazon-bedrock-guardrails-configuration>Amazon Bedrock Guardrails Configuration</a></li><li><a href=#tokenization-workflow-integration>Tokenization Workflow Integration</a><ul><li><a href=#1-apply-guardrails-to-detect-pii-entities>1. Apply Guardrails to Detect PII Entities</a></li><li><a href=#2-invoke-the-tokenization-service>2. Invoke the Tokenization Service</a></li><li><a href=#3-replace-guardrail-masks-with-tokens>3. Replace Guardrail Masks with Tokens</a></li><li><a href=#4-downstream-application-processing>4. Downstream Application Processing</a></li></ul></li><li><a href=#cleanup>Cleanup</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 1</h1><h1 id=artificial-intelligence-integrating-tokenization-with-amazon-bedrock-guardrails-for-secure-data-processing>Artificial Intelligence: Integrating Tokenization with Amazon Bedrock Guardrails for Secure Data Processing</h1><p>Written by <strong>Nizar Kheir</strong> and <strong>Mark Warner</strong> | <strong>September 23, 2025</strong> | Category: <strong>Amazon API Gateway, Amazon Bedrock Guardrails, AWS Lambda, AWS Step Functions, Partner solutions, Technical How-to</strong> |</p><p>This post is co-written by Mark Warner, Principal Solutions Architect for Thales, Cyber Security Products.</p><p>As Generative AI applications move into production environments, they integrate with a wider scope of business systems that handle <strong>sensitive customer data</strong>. This integration introduces new challenges around protecting <strong>Personally Identifiable Information (PII)</strong> while maintaining <strong>data reversibility</strong> for downstream applications that legitimately require it. Consider a financial services company deploying generative AI across different departments. The customer service team needs an AI assistant that can access customer records and provide personalized responses including contact information. Meanwhile, the fraud analysis team requires the same customer data but must analyze patterns without exposing the actual PII, working only with protected representations of the sensitive information.</p><p><strong>Amazon Bedrock Guardrails</strong> helps detect sensitive information, such as PII, in a standard format within input prompts or model responses. Sensitive information filters give organizations control over how sensitive data is handled, with options to block requests containing PII or to <strong>mask</strong> sensitive information with generic placeholders like <code>{NAME}</code> or <code>{EMAIL}</code>.</p><p>While masking effectively protects sensitive information, it introduces a new challenge: the <strong>loss of data reversibility</strong>. When guardrails replace sensitive data with generic masks, the original information becomes inaccessible to downstream applications that might need it for legitimate business processes.</p><p><strong>Tokenization</strong> offers a complementary approach to this challenge. Unlike masking, tokenization replaces sensitive data with <strong>format-preserving tokens</strong> that are mathematically unrelated to the original information but still maintain its structure and usability. These tokens can be safely <strong>reversed</strong> back to their original value when needed by authorized systems, creating a path for secure data flow throughout an organization&rsquo;s environment.</p><p>In this post, we show you how to integrate Amazon Bedrock Guardrails with third-party tokenization services to protect sensitive data while maintaining data reversibility. The solution described demonstrates how to combine Amazon Bedrock Guardrails with tokenization services from the <strong>Thales CipherTrust Data Security Platform</strong> to create an architecture that protects sensitive data without sacrificing the ability to process that data securely when needed.</p><hr><h2 id=amazon-bedrock-guardrails-apis>Amazon Bedrock Guardrails APIs</h2><p>Amazon Bedrock Guardrails offers two distinct approaches for implementing content safety controls:</p><ul><li><strong>Direct integration</strong> with model invocation via APIs like <code>InvokeModel</code> and <code>Converse</code>.</li><li><strong>Independent evaluation</strong> via the <strong>ApplyGuardrail API</strong>, which decouples guardrail assessment from model invocation.</li></ul><p>This post utilizes the <strong>ApplyGuardrail API</strong> for tokenization integration because it separates the content assessment from the model call, allowing the insertion of the tokenization process between these steps.</p><p>The solution extends a typical <code>ApplyGuardrail</code> API deployment by inserting the tokenization processing between the guardrail assessment and the model invocation, as follows:</p><ol><li>The application calls the <strong>ApplyGuardrail API</strong> to assess the user input for sensitive information.</li><li>If sensitive information is detected (<code>action = "ANONYMIZED"</code>):<ul><li>The application captures the detected PII and its location.</li><li>It calls a tokenization service to convert these entities into <strong>format-preserving tokens</strong>.</li><li>It replaces the generic guardrail masks with these tokens.</li></ul></li><li>The application then calls the foundation model with the tokenized content.</li></ol><hr><h2 id=solution-overview>Solution Overview</h2><p>To illustrate how this workflow provides value in practice, consider a financial advisory application. Three separate application components work together to provide secure, AI-powered financial insights:</p><ul><li><strong>Customer gateway service:</strong> This trusted interface coordinator receives customer queries that often contain sensitive information.</li><li><strong>Financial analysis engine:</strong> This AI-powered component analyzes financial patterns and generates recommendations but does not need access to the actual customer PII. It operates with anonymized or tokenized information.</li><li><strong>Response processing service:</strong> This trusted service handles the final communication with the customer, including <strong>detokenizing</strong> sensitive information before presenting the result to the customer.</li></ul><p>The workflow is orchestrated by <strong>AWS Step Functions</strong> and uses <strong>AWS Lambda</strong> functions to sequence PII detection, tokenization, AI model invocation, and detokenization across the three main components:</p><ol><li>The <strong>Customer gateway service</strong> receives user input $\rightarrow$ Calls <strong>ApplyGuardrail API</strong>.</li><li>Guardrail detects PII $\rightarrow$ The gateway service calls the <strong>tokenization service</strong> (e.g., Thales CipherTrust) to generate <strong>format-preserving tokens</strong>.</li><li>The input with tokenized values (e.g., <code>[[TOKEN_123]]</code>) is passed to the <strong>Financial analysis engine</strong>.</li><li>The analysis engine calls an <strong>LLM on Amazon Bedrock</strong> to generate financial advice using the tokenized data.</li><li>The model response (which may contain tokens) is sent to the <strong>Response processing service</strong>.</li><li>This service calls the tokenization service to <strong>detokenize</strong>, restoring the original sensitive values.</li><li>The final, detokenized response is sent to the customer.</li></ol><p>This architecture maintains data security throughout the processing flow while preserving the utility of the information.</p><hr><h2 id=prerequisites>Prerequisites</h2><p>To deploy the described solution, you must have the following components configured in your environment:</p><ul><li>An <strong>AWS account</strong> with <strong>Amazon Bedrock</strong> enabled.</li><li>Appropriate <strong>AWS Identity and Access Management (IAM) permissions</strong>: <code>bedrock:CreateGuardrail</code>, <code>bedrock:ApplyGuardrail</code>, and <code>bedrock-runtime:InvokeModel</code>.</li><li>A <strong>Python 3.7+ environment</strong> with the <code>boto3</code> library and configured AWS credentials.</li><li>A deployed <strong>tokenization service</strong> accessible via REST API endpoints (e.g., Thales CipherTrust Data Security Platform).</li></ul><hr><h2 id=amazon-bedrock-guardrails-configuration>Amazon Bedrock Guardrails Configuration</h2><p>Use the AWS SDK to configure the Guardrail with a sensitive information policy to <strong>ANONYMIZE</strong> PII types such as <code>URL</code>, <code>EMAIL</code>, and <code>NAME</code> for both inputs and outputs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> boto3
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_bedrock_guardrail</span>():
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Create a guardrail in Amazon Bedrock for financial applications with PII protection.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    bedrock <span style=color:#f92672>=</span> boto3<span style=color:#f92672>.</span>client(<span style=color:#e6db74>&#39;bedrock&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> bedrock<span style=color:#f92672>.</span>create_guardrail(
</span></span><span style=display:flex><span>        name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;FinancialServiceGuardrail&#34;</span>,
</span></span><span style=display:flex><span>        description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Guardrail for financial applications with PII protection&#34;</span>,
</span></span><span style=display:flex><span>        sensitiveInformationPolicyConfig<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;piiEntitiesConfig&#39;</span>: [
</span></span><span style=display:flex><span>                {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;URL&#39;</span>, <span style=color:#e6db74>&#39;action&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;inputAction&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;outputAction&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;inputEnabled&#39;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#39;outputEnabled&#39;</span>: <span style=color:#66d9ef>True</span>},
</span></span><span style=display:flex><span>                {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;EMAIL&#39;</span>, <span style=color:#e6db74>&#39;action&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;inputAction&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;outputAction&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;inputEnabled&#39;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#39;outputEnabled&#39;</span>: <span style=color:#66d9ef>True</span>},
</span></span><span style=display:flex><span>                {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;NAME&#39;</span>, <span style=color:#e6db74>&#39;action&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;inputAction&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;outputAction&#39;</span>: <span style=color:#e6db74>&#39;ANONYMIZE&#39;</span>, <span style=color:#e6db74>&#39;inputEnabled&#39;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#39;outputEnabled&#39;</span>: <span style=color:#66d9ef>True</span>}
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        blockedInputMessaging<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;I can&#39;t provide information with PII data.&#34;</span>,
</span></span><span style=display:flex><span>        blockedOutputsMessaging<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;I can&#39;t generate content with PII data.&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> response
</span></span></code></pre></div><hr><h2 id=tokenization-workflow-integration>Tokenization Workflow Integration</h2><h3 id=1-apply-guardrails-to-detect-pii-entities>1. Apply Guardrails to Detect PII Entities</h3><p>Use the <strong>ApplyGuardrail API</strong> to validate the input text:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>invoke_guardrail</span>(user_query):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#... (ApplyGuardrail API call logic)</span>
</span></span><span style=display:flex><span>    bedrock_runtime <span style=color:#f92672>=</span> boto3<span style=color:#f92672>.</span>client(<span style=color:#e6db74>&#39;bedrock-runtime&#39;</span>)
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> bedrock_runtime<span style=color:#f92672>.</span>apply_guardrail(
</span></span><span style=display:flex><span>        guardrailIdentifier<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;your-guardrail-id&#39;</span>, 
</span></span><span style=display:flex><span>        guardrailVersion<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;your-guardrail-version&#39;</span>, 
</span></span><span style=display:flex><span>        source<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;INPUT&#34;</span>,
</span></span><span style=display:flex><span>        content<span style=color:#f92672>=</span>[{<span style=color:#e6db74>&#34;text&#34;</span>: {<span style=color:#e6db74>&#34;text&#34;</span>: user_query}}]
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> response
</span></span></code></pre></div><h3 id=2-invoke-the-tokenization-service>2. Invoke the Tokenization Service</h3><p>Parse the response from the Guardrail and call the third-party tokenization service (e.g., Thales CipherTrust) to convert the sensitive values into tokens.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>thales_ciphertrust_tokenizer</span>(guardrail_response):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#... (logic to extract PII entities)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#... (logic to call Thales CipherTrust /v1/protect endpoint)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Get sensitive_value and call API</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># response = requests.post(url_str, headers=headers, data=json.dumps(crdp_payload))</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># protected_results.append({...})</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#...</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span></code></pre></div><h3 id=3-replace-guardrail-masks-with-tokens>3. Replace Guardrail Masks with Tokens</h3><p>Replace the generic guardrail masks (<code>{EMAIL}</code>, <code>{URL}</code>, etc.) in the guardrail&rsquo;s output with the generated format-preserving tokens.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>process_guardrail_output</span>(protected_results, guardrail_response):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#... (replacement logic)</span>
</span></span><span style=display:flex><span>    protection_map <span style=color:#f92672>=</span> {res[<span style=color:#e6db74>&#39;type&#39;</span>]<span style=color:#f92672>.</span>upper(): res[<span style=color:#e6db74>&#39;protection_response&#39;</span>][<span style=color:#e6db74>&#39;protected_data&#39;</span>] <span style=color:#66d9ef>for</span> res <span style=color:#f92672>in</span> protected_results}
</span></span><span style=display:flex><span>    modified_outputs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> output_item <span style=color:#f92672>in</span> guardrail_response<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;outputs&#39;</span>, []):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;text&#39;</span> <span style=color:#f92672>in</span> output_item:
</span></span><span style=display:flex><span>            modified_text <span style=color:#f92672>=</span> output_item[<span style=color:#e6db74>&#39;text&#39;</span>]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> pii_type, protected_value <span style=color:#f92672>in</span> protection_map<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>                modified_text <span style=color:#f92672>=</span> modified_text<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>{{</span><span style=color:#e6db74>{</span>pii_type<span style=color:#e6db74>}</span><span style=color:#ae81ff>}}</span><span style=color:#e6db74>&#34;</span>, protected_value) <span style=color:#75715e># Replace {PII_TYPE} with token</span>
</span></span><span style=display:flex><span>            modified_outputs<span style=color:#f92672>.</span>append({<span style=color:#e6db74>&#34;text&#34;</span>: modified_text})
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> modified_outputs
</span></span></code></pre></div><p><strong>Example of Sanitized Input:</strong></p><ul><li><strong>Original Input:</strong> <code>"Hi, this is john.smith@example.com. Based on my last five transactions on acme.com..."</code></li><li><strong>Tokenized (Sanitized) Input:</strong> <code>"Hi, this is 1001000GC5gDh1.D8eK71@EjaWV.lhC. Based on my last five transactions on 1001000WcFzawG.Jc9Tfc..."</code></li></ul><h3 id=4-downstream-application-processing>4. Downstream Application Processing</h3><p>The financial analysis engine can call the LLM with the tokenized data to generate a relevant response. The <strong>response processing service</strong> then calls the tokenization service&rsquo;s <strong>Detokenize API</strong> (e.g., Thales CipherTrust) to <strong>detokenize</strong> the tokens and restore the original values before sending the final response to the customer.</p><hr><h2 id=cleanup>Cleanup</h2><p>To avoid incurring additional charges, delete the AWS resources you created after testing:</p><ol><li>Delete the guardrails you created (refer to the Amazon Bedrock documentation on deleting a guardrail).</li><li>Delete the AWS Lambda, API Gateway, or Step Functions resources if you deployed the full workflow.</li><li>Refer to the documentation for your third-party tokenization solution (e.g., Thales CipherTrust) for instructions on appropriate resource removal.</li></ol><hr><h2 id=conclusion>Conclusion</h2><p>Combining <strong>Amazon Bedrock Guardrails</strong> with <strong>tokenization</strong> (e.g., Thales CipherTrust) provides a robust solution for protecting <strong>PII</strong> within generative AI workflows while preserving the necessary <strong>data utility and reversibility</strong> for authorized downstream applications. This approach helps organizations in tightly regulated industries balance generative AI innovation with compliance requirements.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/ title="Translated Blogs"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../3-blogstranslated/3.2-blog2/ title="Blog 2" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765453894></script><script src=../../js/perfect-scrollbar.min.js?1765453894></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765453894></script><script src=../../js/jquery.sticky.js?1765453894></script><script src=../../js/featherlight.min.js?1765453894></script><script src=../../js/highlight.pack.js?1765453894></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765453894></script><script src=../../js/learn.js?1765453894></script><script src=../../js/hugo-learn.js?1765453894></script><link href=../../mermaid/mermaid.css?1765453894 rel=stylesheet><script src=../../mermaid/mermaid.js?1765453894></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>